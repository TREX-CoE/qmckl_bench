#+TITLE: Performance tests for QMCkl.

* Installation

1. Download and install QMCkl
2. Compile the current tests and run

#+begin_src  bash
./autogen.sh
./configure
make
./bench_jastrow
#+end_src

* Results

** CPU
  Intel(R) Xeon(R) CPU E3-1271 v3 @ 3.60GHz, 4cores

** GNU options for QMCkl

  #+begin_src bash
./configure \
    CC=gcc \
    CFLAGS="-g -O2 -march=native  -flto -fno-trapping-math -fno-math-errno -ftree-vectorize" \
    FC=gfortran \
    FCFLAGS="-g -O2 -march=native  -flto -ftree-vectorize" \
    --enable-hpc --with-openmp --enable-static
  #+end_src


** Intel options for QMCkl

  #+begin_src bash
./configure --with-icc --with-ifort --enable-hpc --with-openmp --enable-static

# -xHost -ip -O2 -ftz -finline -g -mkl=sequential -fopenmp
  #+end_src


** Measures

| HPC | Compiler | NCores | bench_aos (ms) |
|-----+----------+--------+----------------|
| No  | Gnu      |      1 |          132.0 |
| No  | Gnu      |      4 |          131.6 |
| Yes | Gnu      |      1 |           66.9 |
| Yes | Gnu      |      4 |           24.6 |
| Yes | Intel    |      1 |           59.9 |
| Yes | Intel    |      4 |           23.5 |

** Memo

   Run MAQAO with

   #+begin_src bash
maqao oneview --create-report=three --output-format=html --force-all-loops --external-libraries={\"libqmckl.so.0\"} ./bench_aos
   #+end_src
